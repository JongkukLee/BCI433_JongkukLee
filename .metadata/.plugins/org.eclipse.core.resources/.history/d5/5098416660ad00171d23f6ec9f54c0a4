000100171009     FMARKSDSP  CF   E             WORKSTN
000101171009      /FREE
000102171009       EXFMT GETVALUE;
000103171009       DOW NOT(*IN03);
000104171009         EXSR DETERMINETAX;
000105171009         *IN99 = *ON;
000106171009         WRITE GETVALUE;
000107171009         EXFMT SHOWTAX;
000108171009         *IN99 = *OFF;
000109171009         IF *IN03 = *OFF;
000110171009           EXSR CLEAR;
000111171009           EXFMT GETVALUE;
000112171009         ENDIF;
000113171009       ENDDO;
000114171009       *INLR = *ON;
000115171009       RETURN;
000116171009
000117171009       // set the Letter Grade
000118171009       BEGSR DETERMINETAX;
000119171009         TESTOVRALL = (TEST1 + TEST2 + TEST3) / 3; // set to 'Tests' on screen
000120171009         NUMGRADE = LAB + ((TEST1 + TEST2 + TEST3) / 3 * 0.35) + (EXAM * 0.35);
000121171009         // set to 'Final Grade' on screen
000122171009         SELECT;
000123171009           WHEN 90 <= NUMGRADE;
000124171009             LETGRADE = 'A+';
000125171009           WHEN 80 <= NUMGRADE AND NUMGRADE <= 89;
000126171009             LETGRADE = 'A';
000127171009           WHEN 75 <= NUMGRADE AND NUMGRADE <= 79;
000128171009             LETGRADE = 'B+';
000129171009           WHEN 70 <= NUMGRADE AND NUMGRADE <= 74;
000130171009             LETGRADE = 'B';
000131171009           WHEN 65 <= NUMGRADE AND NUMGRADE <= 69;
000132171009             LETGRADE = 'C+';
000133171009           WHEN 60 <= NUMGRADE AND NUMGRADE <= 64;
000134171009             LETGRADE = 'C';
000135171009           WHEN 55 <= NUMGRADE AND NUMGRADE <= 59;
000136171009             LETGRADE = 'D+';
000137171009           WHEN 50 <= NUMGRADE AND NUMGRADE <= 54;
000138171009             LETGRADE = 'D';
000139171009           WHEN NUMGRADE <= 49;
000140171009             LETGRADE = 'F+';
000141171009           OTHER;
000142171009             LETGRADE = 'NO';
000143171009         ENDSL;
000144171009       ENDSR;
000145171009
000146171009       // reset the marks back to 0
000147171009       BEGSR CLEARMARKS;
000148171009         TEST1 = 0;
000149171009         TEST2 = 0;
000150171009         TEST3 = 0;
000151171009         LAB = 0;
000152171009         EXAM = 0;
000153171009       ENDSR;
