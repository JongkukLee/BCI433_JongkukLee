000100171009     FMARKSDSP  CF   E             WORKSTN
000101171009      /FREE
000102171009       EXFMT RECORD1;
000103171009       DOW NOT(*IN03);
000104171009         EXSR GETGRADE; // call subroutine to get letter grade
000105171009          WRITE RECORD1;
000106171009         EXFMT RECORD2;
000107171009         IF *IN03 = *OFF;
000108171009           EXSR CLEARMARKS; // call subroutine to clear test score
000109171009           EXFMT RECORD1;
000110171009         ENDIF;
000111171009       ENDDO;
000112171009       *INLR = *ON;
000113171009       RETURN;
000114171009
000115171009       // set the Letter Grade
000116171009       BEGSR GETGRADE;
000117171009         TESTOVRALL = (TEST1 + TEST2 + TEST3) / 3; // set to 'Tests' on screen
000118171009         NUMGRADE = LAB + ((TEST1 + TEST2 + TEST3) / 3 * 0.35) + (EXAM * 0.35); 
000119171009         // set to 'Final Grade' on screen
000120171009         SELECT;
000121171009           WHEN 90 <= NUMGRADE;
000122171009             LETGRADE = 'A+';
000123171009           WHEN 80 <= NUMGRADE AND NUMGRADE <= 89;
000124171009             LETGRADE = 'A';
000125171009           WHEN 75 <= NUMGRADE AND NUMGRADE <= 79;
000126171009             LETGRADE = 'B+';
000127171009           WHEN 70 <= NUMGRADE AND NUMGRADE <= 74;
000128171009             LETGRADE = 'B';
000129171009           WHEN 65 <= NUMGRADE AND NUMGRADE <= 69;
000130171009             LETGRADE = 'C+';
000131171009           WHEN 60 <= NUMGRADE AND NUMGRADE <= 64;
000132171009             LETGRADE = 'C';
000133171009           WHEN 55 <= NUMGRADE AND NUMGRADE <= 59;
000134171009             LETGRADE = 'D+';
000135171009           WHEN 50 <= NUMGRADE AND NUMGRADE <= 54;
000136171009             LETGRADE = 'D';
000137171009           WHEN NUMGRADE <= 49;
000138171009             LETGRADE = 'F+';
000139171009           OTHER;
000140171009             LETGRADE = 'NO';
000141171009         ENDSL;
000142171009       ENDSR;
000143171009
000144171009       // reset the marks back to 0
000145171009       BEGSR CLEARMARKS;
000146171009         TEST1 = 0;
000147171009         TEST2 = 0;
000148171009         TEST3 = 0;
000149171009         LAB = 0;
000150171009         EXAM = 0;
000151171009       ENDSR;
