000100171009     FMARKSDSP  CF   E             WORKSTN
000101171009      /FREE
000102171009       EXFMT GETVALUE;
000103171009       DOW NOT(*IN03);
000104171009         EXSR DETERMINETAX;
000105171009         *IN99 = *ON;
000106171009         WRITE GETVALUE;
000107171009         EXFMT SHOWTAX;
000108171009         *IN99 = *OFF;
000109171009         IF *IN03 = *OFF;
000110171009           EXSR CLEAR;
000111171009           EXFMT GETVALUE;
000112171009         ENDIF;
000113171009       ENDDO;
000114171009       *INLR = *ON;
000115171009       RETURN;
000116171009
000117171009       BEGSR DETERMINETAX;
000119171009         SELECT;
000120171009           WHEN OWNERTYPE = 'C';
000121171009             PROTOTYPE = 'Commercial';
000122171009             SELECT
000123171009  		      WHEN (VALUE >= 500000);
000124171009		        TAXAMT = .025 * VALUE;
000125171009  		      WHEN (VALUE >= 375000);
000126171009		        TAXAMT = .02 * VALUE;
000141171009  		      WHEN (VALUE >= 250000);
000142171009		        TAXAMT = .016 * VALUE;
000143171009  		      WHEN (VALUE >= 1);
000144171009		        TAXAMT = .0125 * VALUE;
000145171009 		    ENDSL;
000146171009
000147171009           WHEN OWNERTYPE = 'R';
000148171009             PROTOTYPE = 'Residential';
000149171009
000150171009       ENDSR;
000151171009
000152171009       // reset the marks back to 0
000153171009       BEGSR CLEARMARKS;
000154171009         TEST1 = 0;
000155171009         TEST2 = 0;
000156171009         TEST3 = 0;
000157171009         LAB = 0;
000158171009         EXAM = 0;
000159171009       ENDSR;
